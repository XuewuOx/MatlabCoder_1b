function main
% test meanfile over data file wtrir_foam200.txt
gfit_rdfile_mex('meanfile','.\work_gfit_rdfile\wtrir_foam3000.txt')
return;
%% clearing
fclose all; close all; clear all; 
clc; pause(0.1);
%% read file
A=importdata('iruvdatafile.txt',' ');

%% data
x=1:100;
% sigma=15; mu=40; A=3;
% y=A*exp(-(x-mu).^2/(2*sigma^2))+rand(size(x))*0.3;
y=getRand(10393);
plot(x,y,'o');

% [0.303821, 0.311055, 0.174043, 0.394041, 0.338620, 0.309143, 0.305695, 0.435887, 0.374960, 0.526537, 0.629192, 0.653005, 0.696577, 0.851239, 0.899247, 0.884926, 1.181922, 1.050445, 1.240223, 1.245884, 1.377507, 1.659480, 1.610336, 1.952785, 1.989051, 2.108555, 2.219039, 2.450014, 2.393002, 2.582050, 2.559534, 2.897824, 2.790233, 2.782818, 2.986749, 3.014831, 3.090156, 3.203796, 3.011389, 3.239696, 3.007945, 3.258323, 3.205563, 3.018185, 2.929850, 2.878849, 2.832436, 2.798355, 2.554165, 2.541280, 2.499958, 2.306745, 2.357258, 2.059006, 2.067178, 1.961989, 1.683153, 1.678640, 1.564292, 1.365338, 1.271712, 1.170191, 1.146003, 1.129300, 1.016484, 0.806275, 0.758032, 0.794164, 0.714873, 0.589967, 0.623753, 0.570508, 0.564563, 0.374549, 0.370969, 0.307524, 0.268722, 0.208813, 0.215837, 0.350725, 0.239483, 0.327043, 0.131125, 0.212459, 0.263343, 0.044599, 0.299569, 0.032967, 0.187397, 0.225989, 0.076767, 0.025444, 0.058348, 0.061505, 0.143731, 0.134646, 0.091470, 0.188604, 0.076783, 0.173461, ]
% sigma=19.880733, mu=40.826288, A=2.321567
% y=[0.303821, 0.311055, 0.174043, 0.394041, 0.338620, 0.309143, 0.305695, 0.435887, 0.374960, 0.526537, 0.629192, 0.653005, 0.696577, 0.851239, 0.899247, 0.884926, 1.181922, 1.050445, 1.240223, 1.245884, 1.377507, 1.659480, 1.610336, 1.952785, 1.989051, 2.108555, 2.219039, 2.450014, 2.393002, 2.582050, 2.559534, 2.897824, 2.790233, 2.782818, 2.986749, 3.014831, 3.090156, 3.203796, 3.011389, 3.239696, 3.007945, 3.258323, 3.205563, 3.018185, 2.929850, 2.878849, 2.832436, 2.798355, 2.554165, 2.541280, 2.499958, 2.306745, 2.357258, 2.059006, 2.067178, 1.961989, 1.683153, 1.678640, 1.564292, 1.365338, 1.271712, 1.170191, 1.146003, 1.129300, 1.016484, 0.806275, 0.758032, 0.794164, 0.714873, 0.589967, 0.623753, 0.570508, 0.564563, 0.374549, 0.370969, 0.307524, 0.268722, 0.208813, 0.215837, 0.350725, 0.239483, 0.327043, 0.131125, 0.212459, 0.263343, 0.044599, 0.299569, 0.032967, 0.187397, 0.225989, 0.076767, 0.025444, 0.058348, 0.061505, 0.143731, 0.134646, 0.091470, 0.188604, 0.076783, 0.173461];
% sigma=16.053147, mu=39.447757, A=3.094664

%% fitting
[sigmaNew,muNew,Anew]=gfit(x,y);
y=Anew*exp(-(x-muNew).^2/(2*sigmaNew^2));
hold on; plot(x,y,'.r');
title(sprintf('Gaussian fitting over simulated data \n sig=%.2f, mu=%.2f, A=%.2f',sigmaNew, muNew, Anew));

%% mex test: read ref.txt file and do Gaussian fitting

fnamescan='refscan_20130205_16h42m02s.txt';
fnamemeas='wtrmeas.txt';

localFolder='E:\Beagle\Eclipseworkspace\MatlabCoder_1b';
remotefilename=strcat('/home/ubuntu/Loadmon_BeaglePlus/',fnamescan);
fprintf('Fetch remote file %s\n', remotefilename);
scptomatlab('ubuntu','10.2.1.239','temppwd',localFolder,remotefilename);
figure;
gfit_rdfile_mex(fnamescan)

%% test gfit.m only, data file is read by importdata() 
% plotscandata.m is at .\MatlabCoder_1b\manual_from_mbed
plotscandata(fnamescan);

